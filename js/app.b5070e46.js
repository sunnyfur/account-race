(function(){"use strict";var e={6835:function(e,t,a){var r=a(9242),n=a(3396);const o={class:"nav"},s={class:"main"};function l(e,t){const a=(0,n.up)("router-link"),r=(0,n.up)("router-view");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n._)("nav",o,[(0,n.Wm)(a,{class:"router-link",to:"/"},{default:(0,n.w5)((()=>[(0,n.Uk)("Заявка")])),_:1}),(0,n.Wm)(a,{class:"router-link",to:"/participants"},{default:(0,n.w5)((()=>[(0,n.Uk)("Участники")])),_:1}),(0,n.Wm)(a,{class:"router-link",to:"/profile"},{default:(0,n.w5)((()=>[(0,n.Uk)("Профиль")])),_:1})]),(0,n._)("main",s,[(0,n.Wm)(r)])],64)}var i=a(89);const c={},u=(0,i.Z)(c,[["render",l]]);var d=u,m=a(2483);const p={class:"container"};function h(e,t,a,r,o,s){const l=(0,n.up)("login-form"),i=(0,n.up)("form-view");return(0,n.wg)(),(0,n.iD)("div",p,[e.isAgree?((0,n.wg)(),(0,n.j4)(l,{key:0,user:e.user,title:o.titleLogin,onSubmit:e.registerUser},null,8,["user","title","onSubmit"])):((0,n.wg)(),(0,n.j4)(i,{key:1,race:e.race,onSubmit:e.registerRace,title:o.titleSend},null,8,["race","onSubmit","title"]))])}var g=a(7139);function v(e,t,a,o,s,l){const i=(0,n.up)("common-input"),c=(0,n.up)("common-field"),u=(0,n.up)("common-select"),d=(0,n.up)("common-button");return(0,n.wg)(),(0,n.iD)("form",{onSubmit:t[8]||(t[8]=(0,r.iM)((()=>{}),["prevent"])),class:"form"},[(0,n.Wm)(c,{label:"ФИО",name:"name",error:o.v$.currRace.name.$errors},{default:(0,n.w5)((()=>[(0,n.Wm)(i,{name:"name",modelValue:o.v$.currRace.name.$model,"onUpdate:modelValue":t[0]||(t[0]=e=>o.v$.currRace.name.$model=e),type:"text",placeholder:"Фамилия Имя Отчество"},null,8,["modelValue"])])),_:1},8,["error"]),(0,n.Wm)(c,{label:"Дата рождения",name:"birthday",error:o.v$.currRace.birthday.$errors},{default:(0,n.w5)((()=>[(0,n.Wm)(i,{name:"birthday",modelValue:o.v$.currRace.birthday.$model,"onUpdate:modelValue":t[1]||(t[1]=e=>o.v$.currRace.birthday.$model=e),type:"date",max:s.maxDate},null,8,["modelValue","max"])])),_:1},8,["error"]),(0,n.Wm)(c,{label:"Email",name:"email",error:o.v$.currRace.email.$errors},{default:(0,n.w5)((()=>[(0,n.Wm)(i,{name:"email",modelValue:o.v$.currRace.email.$model,"onUpdate:modelValue":t[2]||(t[2]=e=>o.v$.currRace.email.$model=e),type:"email",placeholder:"email"},null,8,["modelValue"])])),_:1},8,["error"]),(0,n.Wm)(c,{label:"Телефон",name:"phone",error:o.v$.currRace.phone.$errors},{default:(0,n.w5)((()=>[(0,n.Wm)(i,{name:"phone",modelValue:o.v$.currRace.phone.$model,"onUpdate:modelValue":t[3]||(t[3]=e=>o.v$.currRace.phone.$model=e),type:"tel",placeholder:"+7 XXX XXX XX XX",onKeyup:l.toMask},null,8,["modelValue","onKeyup"])])),_:1},8,["error"]),(0,n.Wm)(c,{label:"Дистанция",name:"distance",error:o.v$.currRace.distance.$errors},{default:(0,n.w5)((()=>[(0,n.Wm)(u,{modelValue:o.v$.currRace.distance.$model,"onUpdate:modelValue":t[4]||(t[4]=e=>o.v$.currRace.distance.$model=e),options:s.optionsDistances},null,8,["modelValue","options"])])),_:1},8,["error"]),(0,n.Wm)(c,{label:"Сумма взноса, руб.",name:"payment",error:o.v$.currRace.payment.$errors},{default:(0,n.w5)((()=>[(0,n.Wm)(i,{name:"payment",modelValue:o.v$.currRace.payment.$model,"onUpdate:modelValue":t[5]||(t[5]=e=>o.v$.currRace.payment.$model=e),type:"number",min:"10",max:"10000"},null,8,["modelValue"])])),_:1},8,["error"]),(0,n._)("label",null,[(0,n.wy)((0,n._)("input",{type:"checkbox","onUpdate:modelValue":t[6]||(t[6]=e=>s.isAgree=e)},null,512),[[r.e8,s.isAgree]]),(0,n.Uk)("Согласие на создание профиля ")]),(0,n.Wm)(d,{disabled:o.v$.currRace.$invalid,onClick:t[7]||(t[7]=t=>e.$emit("submit",{race:s.currRace,isAgree:s.isAgree}))},{default:(0,n.w5)((()=>[(0,n.Uk)((0,g.zw)(a.title),1)])),_:1},8,["disabled"])],32)}var w=a(3053),f=a(9117);const y=()=>{const e=new Date;return e.setDate(e.getDate()+5),e.toISOString().split("T")[0]},b=e=>new Date((new Date).setFullYear((new Date).getFullYear()-14))>=new Date(e);var _={data(){return{currRace:{},optionsDistances:[{value:3,name:"3 км"},{value:5,name:"5 км"},{value:10,name:"10 км"}],isAgree:!1,maxDate:y()}},props:{race:{type:Object,required:!0},title:{type:String,required:!0}},setup(){return{v$:(0,w.ZP)()}},mounted(){this.currRace={...this.race}},methods:{toMask(e){let t=e.target.value;const a=t.replace(/\D/gi,"").match(/(\d{0,1})(\d{0,3})(\d{0,3})(\d{0,2})(\d{0,2})/);a[2]||""===a[1]?this.currRace.phone="+7 "+a[2]+(a[3]?" "+a[3]:"")+(a[4]?" "+a[4]:"")+(a[5]?" "+a[5]:""):this.currRace.phone="7"===a[1]||"8"===a[1]?"+7 ":"+7 "+a[1]}},validations(){return{currRace:{name:{required:f.BM.withMessage("Поле обязательно для заполнения",f.C1)},birthday:{required:f.BM.withMessage("Поле обязательно для заполнения",f.C1),maxValue:f.BM.withMessage("Регистрация возможна с 14 лет",b)},email:{required:f.BM.withMessage("Поле обязательно для заполнения",f.C1),email:f.BM.withMessage("Введите корректный email",f.Do)},phone:{required:f.BM.withMessage("Поле обязательно для заполнения",f.C1)},distance:{required:f.BM.withMessage("Поле обязательно для заполнения",f.C1)},payment:{required:f.BM.withMessage("Поле обязательно для заполнения",f.C1),minValue:f.BM.withMessage("Минимальное значение 10",(0,f.uv)(10)),maxValue:f.BM.withMessage("Максимальное значение 10 000",(0,f.PW)(1e4))}}}}};const $=(0,i.Z)(_,[["render",v]]);var R=$;function S(e,t,a,o,s,l){const i=(0,n.up)("common-input"),c=(0,n.up)("common-button");return(0,n.wg)(),(0,n.iD)("form",{onSubmit:t[3]||(t[3]=(0,r.iM)((()=>{}),["prevent"])),class:"form"},[(0,n._)("h2",null,(0,g.zw)(a.title),1),(0,n.Wm)(i,{label:"Логин",type:"text",name:"login",placeholder:"email",modelValue:o.v$.currUser.login.$model,"onUpdate:modelValue":t[0]||(t[0]=e=>o.v$.currUser.login.$model=e),error:o.v$.currUser.login.$errors},null,8,["modelValue","error"]),(0,n.Wm)(i,{label:"Пароль",type:"password",name:"password",modelValue:o.v$.currUser.password.$model,"onUpdate:modelValue":t[1]||(t[1]=e=>o.v$.currUser.password.$model=e),error:o.v$.currUser.password.$errors},null,8,["modelValue","error"]),(0,n.Wm)(c,{onClick:t[2]||(t[2]=t=>e.$emit("submit",s.currUser)),disabled:o.v$.currUser.$invalid},{default:(0,n.w5)((()=>[(0,n.Uk)((0,g.zw)(a.title),1)])),_:1},8,["disabled"])],32)}var k={data(){return{currUser:{}}},props:{user:{type:Object,required:!0},title:{type:String,required:!0}},setup(){return{v$:(0,w.ZP)()}},mounted(){this.currUser={...this.user}},validations(){return{currUser:{login:{required:f.BM.withMessage("Поле обязательно для заполнения",f.C1)},password:{required:f.BM.withMessage("Поле обязательно для заполнения",f.C1)}}}}};const V=(0,i.Z)(k,[["render",S]]);var U=V,D=a(65),M={data(){return{titleLogin:"Зарегистрироваться",titleSend:"Отправить заявку"}},components:{FormView:R,LoginForm:U},methods:{...(0,D.nv)({registerUser:"auth/registerUser",registerRace:"auth/registerRace"})},computed:{...(0,D.rn)({isAgree:e=>e.auth.isAgree,race:e=>e.auth.race,user:e=>e.auth.user})}};const O=(0,i.Z)(M,[["render",h]]);var A=O;const W={class:"container_table"};function I(e,t,a,r,o,s){const l=(0,n.up)("common-select"),i=(0,n.up)("table-view");return(0,n.wg)(),(0,n.iD)("div",W,[(0,n.Wm)(l,{"model-value":e.selectedSort,"onUpdate:modelValue":e.setSelectedSort,options:e.sortOptions},null,8,["model-value","onUpdate:modelValue","options"]),(0,n.Wm)(i,{races:e.sortedRaces},null,8,["races"])])}const q=e=>((0,n.dD)("data-v-18eee13a"),e=e(),(0,n.Cn)(),e),x={class:"table"},z=q((()=>(0,n._)("thead",{class:"table__head"},[(0,n._)("tr",{class:"table__row"},[(0,n._)("th",null,"ФИО"),(0,n._)("th",null,"Дата заявки"),(0,n._)("th",null,"E-mail"),(0,n._)("th",null,"Длительность"),(0,n._)("th",null,"Сумма взноса")])],-1))),C={class:"table__data","data-label":"ФИО"},Z={class:"table__data","data-label":"Дата заявки"},j={class:"table__data","data-label":"E-mail"},B={class:"table__data","data-label":"Длительность"},E={class:"table__data","data-label":"Сумма взноса"};function X(e,t,a,r,o,s){return(0,n.wg)(),(0,n.iD)("table",x,[z,(0,n._)("tbody",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(a.races,(e=>((0,n.wg)(),(0,n.iD)("tr",{class:"table__row",key:e.id},[(0,n._)("td",C,(0,g.zw)(e.name),1),(0,n._)("td",Z,(0,g.zw)(e.date),1),(0,n._)("td",j,(0,g.zw)(e.email),1),(0,n._)("td",B,(0,g.zw)(e.distance),1),(0,n._)("td",E,(0,g.zw)(e.payment),1)])))),128))])])}var F={props:{races:{type:Array}}};const L=(0,i.Z)(F,[["render",X],["__scopeId","data-v-18eee13a"]]);var P=L,Y={name:"ParticipantsView",components:{TableView:P},methods:{...(0,D.nv)({loadRaces:"races/loadRaces"}),...(0,D.OI)({setSelectedSort:"races/setSelectedSort"})},mounted(){this.loadRaces()},computed:{...(0,D.rn)({races:e=>e.races.races,selectedSort:e=>e.races.selectedSort,sortOptions:e=>e.races.sortOptions}),...(0,D.Se)({sortedRaces:"races/sortedRaces"})}};const N=(0,i.Z)(Y,[["render",I],["__scopeId","data-v-78c3fe71"]]);var J=N;const K={class:"about"};function T(e,t,a,r,o,s){const l=(0,n.up)("form-view"),i=(0,n.up)("login-form");return(0,n.wg)(),(0,n.iD)("div",K,[e.isAuth?((0,n.wg)(),(0,n.j4)(l,{key:0,race:e.race,title:o.titleSend,onSubmit:e.saveRace},null,8,["race","title","onSubmit"])):((0,n.wg)(),(0,n.j4)(i,{key:1,user:e.user,title:o.titleLogin,onSubmit:e.loginUser},null,8,["user","title","onSubmit"]))])}var H={components:{FormView:R,LoginForm:U},data(){return{titleLogin:"Войти",titleSend:"Сохранить"}},methods:{...(0,D.nv)({loginUser:"auth/loginUser",saveRace:"auth/saveRace"})},computed:{...(0,D.rn)({isAuth:e=>e.auth.isAuth,race:e=>e.auth.race,user:e=>e.auth.user})}};const G=(0,i.Z)(H,[["render",T]]);var Q=G;const ee=[{path:"/",name:"home",component:A},{path:"/participants",name:"participants",component:J},{path:"/profile",name:"profile",component:Q}],te=(0,m.p7)({history:(0,m.PO)("/account-race/"),routes:ee});var ae=te;a(7658);const re=(e,t)=>{const a=localStorage.getItem(e);return a?t?JSON.parse(a)[t]:JSON.parse(a):null},ne=(e,t,a)=>{const r=re(e);if(!r)return localStorage.setItem(e,JSON.stringify({[t]:a}));r[t]=a,window.localStorage.setItem(e,JSON.stringify(r))},oe=a(9050),se={state:()=>({races:[],selectedSort:"",sortOptions:[{value:"date",name:"Сортировка по дате"},{value:"payment",name:"Сортировка по сумме взноса"},{value:"distance",name:"Сортировка по дистанции"}]}),getters:{sortedRaces(e){return[...e.races].sort(((t,a)=>"date"==e.selectedSort?new Date(a[e.selectedSort])-new Date(t[e.selectedSort]):a[e.selectedSort]-t[e.selectedSort])).map((e=>({...e,date:new Date(e.date).toLocaleDateString("ru-RU").replace(/\./g,"-")})))}},mutations:{setRaces(e,t){e.races=t},setSelectedSort(e,t){e.selectedSort=t},addRace(e,t){e.races.push(t)}},actions:{loadRaces({commit:e}){let t=re("races","users");t||(t=[]),e("setRaces",t.concat(oe.users)),e("setSelectedSort","date")},addRace({commit:e},t){let a=re("races","users");a||(a=[]),a.push(t),ne("races","users",a),e("addRace",t)},getRace({state:e,dispatch:t},a){return 0==e.races.length&&t("loadRaces"),e.races.filter((e=>e.id===a))[0]},saveRace({state:e,commit:t},a){const r=[e.races.filter((e=>e!=e.id)),a];t("setRaces",r);let n=re("races","users");ne("races","users",[...n].filter((e=>a.id!=e.id)).concat(a))}},namespaced:!0},le=()=>{const e=new Date;return`${e.getFullYear()}-${e.getMonth()+1}-${e.getDate()}`},ie={state:()=>({isAuth:!1,isAgree:!1,race:{name:"",birthday:le(),email:"",phone:"",distance:"",payment:""},user:{id:"",login:""}}),getters:{},mutations:{setIsAuth(e,t){e.isAuth=t},setIsAgree(e,t){e.isAgree=t},setRace(e,t){e.race=t||{name:"",birthday:le(),email:"",phone:"",distance:"",payment:""}},setUser(e,t){e.user=t}},actions:{registerUser({commit:e},t){e("setIsAgree",!1);let a=re("races","logins");if(a||(a=[]),a.filter((e=>e.login===t.login))[0])throw new Error("Пользователь уже зарегистрирован");a.push(t),ne("races","logins",a),e("setUser",{id:"",login:""})},registerRace({state:e,commit:t,dispatch:a},r){const n=new Date;a("races/addRace",{...r.race,id:n,date:n},{root:!0}),r.isAgree&&(t("setUser",{...e.user,id:n,login:r.race.email}),t("setIsAgree",r.isAgree)),t("setRace")},async loginUser({commit:e,dispatch:t},a){const r=re("races","logins");if(!r)throw new Error("Нет зарегистрированных пользователей");const n=r.filter((e=>e.login===a.login))[0];if(!n)throw new Error("Нет пользователя с таким логином");if(n.password!==a.password)throw new Error("Пароль не верен");const o=await t("races/getRace",n.id,{root:!0});e("setRace",o),e("setIsAuth",!0)},saveRace({commit:e,dispatch:t},a){e("setIsAuth",!1),t("races/saveRace",a.race,{root:!0})}},namespaced:!0};var ce=(0,D.MT)({state:()=>({error:null}),mutations:{setError(e,t){e.error=t},clearError(e){e.error=null}},modules:{races:se,auth:ie},namespaced:!0});const ue={class:"btn"};function de(e,t,a,r,o,s){return(0,n.wg)(),(0,n.iD)("button",ue,[(0,n.WI)(e.$slots,"default",{},void 0,!0)])}var me={name:"common-button"};const pe=(0,i.Z)(me,[["render",de],["__scopeId","data-v-70455a61"]]);var he=pe;const ge=["name","id","type","value","placeholder"];function ve(e,t,a,r,o,s){return(0,n.wg)(),(0,n.iD)("input",{class:"input__text",name:a.name,id:a.name,type:a.type,value:a.modelValue,placeholder:a.placeholder,onInput:t[0]||(t[0]=(...e)=>s.updateInput&&s.updateInput(...e))},null,40,ge)}var we={name:"common-input",props:{type:{type:String,default:"text"},name:{type:String,required:!0},placeholder:{type:String},label:{type:String,required:!0},error:{type:Array,required:!1},modelValue:[String,Number,Date]},methods:{updateInput(e){this.$emit("update:modelValue",e.target.value)}}};const fe=(0,i.Z)(we,[["render",ve],["__scopeId","data-v-1478f069"]]);var ye=fe;const be=["value"],_e=["value"];function $e(e,t,a,r,o,s){return(0,n.wg)(),(0,n.iD)("select",{value:a.modelValue,onChange:t[0]||(t[0]=(...e)=>s.changeOption&&s.changeOption(...e))},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(a.options,(e=>((0,n.wg)(),(0,n.iD)("option",{key:e.value,value:e.value},(0,g.zw)(e.name),9,_e)))),128))],40,be)}var Re={name:"common-select",props:{modelValue:{type:String},options:{type:Array,default:()=>[]}},methods:{changeOption(e){this.$emit("update:modelValue",e.target.value)}}};const Se=(0,i.Z)(Re,[["render",$e],["__scopeId","data-v-7ddf71e1"]]);var ke=Se;const Ve={class:"form__input"},Ue=["for"];function De(e,t,a,r,o,s){return(0,n.wg)(),(0,n.iD)("div",Ve,[(0,n._)("label",{for:a.name,class:"input__label"},(0,g.zw)(a.label),9,Ue),(0,n.WI)(e.$slots,"default",{},void 0,!0),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(a.error,(e=>((0,n.wg)(),(0,n.iD)("div",{class:"input__error",key:e.id},[(0,n._)("p",null,(0,g.zw)(e.$message),1)])))),128))])}var Me={name:"common-field",props:{name:{type:String,required:!0},label:{type:String,required:!0},error:{type:Array,required:!1}},methods:{updateInput(e){this.$emit("update:modelValue",e.target.value)}}};const Oe=(0,i.Z)(Me,[["render",De],["__scopeId","data-v-9d355dac"]]);var Ae=Oe,We=[he,ye,ke,Ae];const Ie=(0,r.ri)(d);We.forEach((e=>{Ie.component(e.name,e)})),Ie.use(ce).use(ae).mount("#app")},9050:function(e){e.exports=JSON.parse('{"users":[{"id":1,"date":"1987-03-11","name":"Куклина Мария Ивановна","email":"kyklina@mail.ru","phone":"+79223625999","distance":5,"payment":500},{"id":2,"date":"1997-05-08","name":"Мокрушина Галина Юрьевна","email":"mokrushina@mail.ru","phone":"+79881125999","distance":10,"payment":300},{"id":3,"date":"1986-01-19","name":"Ольга Сергеевна Заводская","email":"olga.zavodckaia@mail.ru","phone":"+79008011000","distance":3,"payment":1500},{"id":4,"date":"1987-03-12","name":"Куклина Валерия Ивановна","email":"kyklinaV@mail.ru","phone":"+79223625999","distance":5,"payment":500},{"id":5,"date":"1997-05-08","name":"Мокрушина Галина Юрьевна","email":"mokrushina@mail.ru","phone":"+79881125999","distance":10,"payment":300},{"id":6,"date":"1986-01-19","name":"Ольга Сергеевна Заводская","email":"olga.zavodckaia@mail.ru","phone":"+79008011000","distance":3,"payment":1500},{"id":7,"date":"1987-03-11","name":"Куклина Мария Ивановна","email":"kyklina@mail.ru","phone":"+79223625999","distance":5,"payment":500},{"id":8,"date":"1997-05-08","name":"Мокрушина Галина Юрьевна","email":"mokrushina@mail.ru","phone":"+79881125999","distance":10,"payment":300},{"id":9,"date":"1986-01-19","name":"Ольга Сергеевна Заводская","email":"olga.zavodckaia@mail.ru","phone":"+79008011000","distance":3,"payment":1500},{"id":10,"date":"1987-03-11","name":"Куклина Мария Ивановна","email":"kyklina@mail.ru","phone":"+79223625999","distance":5,"payment":500},{"id":11,"date":"1997-05-08","name":"Мокрушина Галина Юрьевна","email":"mokrushina@mail.ru","phone":"+79881125999","distance":10,"payment":300},{"id":11,"date":"1986-01-19","name":"Ольга Сергеевна Заводская","email":"olga.zavodckaia@mail.ru","phone":"+79008011000","distance":3,"payment":1500}]}')}},t={};function a(r){var n=t[r];if(void 0!==n)return n.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,a),o.exports}a.m=e,function(){var e=[];a.O=function(t,r,n,o){if(!r){var s=1/0;for(u=0;u<e.length;u++){r=e[u][0],n=e[u][1],o=e[u][2];for(var l=!0,i=0;i<r.length;i++)(!1&o||s>=o)&&Object.keys(a.O).every((function(e){return a.O[e](r[i])}))?r.splice(i--,1):(l=!1,o<s&&(s=o));if(l){e.splice(u--,1);var c=n();void 0!==c&&(t=c)}}return t}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[r,n,o]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};a.O.j=function(t){return 0===e[t]};var t=function(t,r){var n,o,s=r[0],l=r[1],i=r[2],c=0;if(s.some((function(t){return 0!==e[t]}))){for(n in l)a.o(l,n)&&(a.m[n]=l[n]);if(i)var u=i(a)}for(t&&t(r);c<s.length;c++)o=s[c],a.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return a.O(u)},r=self["webpackChunkaccount_race"]=self["webpackChunkaccount_race"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=a.O(void 0,[998],(function(){return a(6835)}));r=a.O(r)})();
//# sourceMappingURL=app.b5070e46.js.map